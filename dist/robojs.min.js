!function(e,t){if("function"==typeof define&&define.amd)define("robojs",["exports"],t);else if("undefined"!=typeof exports)t(exports);else{var n={};t(n),e.robojs=n}}(this,function(e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n=function(e,t,n){window.require([e],t,n)},r=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:n;return Object.freeze({load:function(t){return new Promise(function(n,r){return e(t,n,r)})}})};function i(){this._listeners={}}i.prototype={addEventListener:function(e,t,n){var r,i=(r=n?this._captureListeners=this._captureListeners||{}:this._listeners=this._listeners||{})[e];return i&&this.removeEventListener(e,t,n),(i=r[e])?i.push(t):r[e]=[t],t},removeEventListener:function(e,t,n){var r=n?this._captureListeners:this._listeners;if(r){var i=r[e];if(i)for(var o=0,s=i.length;o<s;o++)if(i[o]==t){1==s?delete r[e]:i.splice(o,1);break}}},removeAllEventListeners:function(e){e?(this._listeners&&delete this._listeners[e],this._captureListeners&&delete this._captureListeners[e]):this._listeners=this._captureListeners=null},dispatchEvent:function(e){if("string"==typeof e){if(!this._listeners||!this._listeners[e])return!1;e=new Event(e)}else e.target&&e.clone&&(e=e.clone());try{e.target=this}catch(e){}if(e.bubbles&&this.parent){for(var t=this,n=[t];t.parent;)n.push(t=t.parent);var r,i=n.length;for(r=i-1;r>=0&&!e.propagationStopped;r--)n[r]._dispatchEvent(e,1+(0==r));for(r=1;r<i&&!e.propagationStopped;r++)n[r]._dispatchEvent(e,3)}else this._dispatchEvent(e,2);return e.defaultPrevented},hasEventListener:function(e){var t=this._listeners,n=this._captureListeners;return!!(t&&t[e]||n&&n[e])},_dispatchEvent:function(e,t){var n,r=1===t?this._captureListeners:this._listeners;if(e&&r){var i=r[e.type];if(!i||!(n=i.length))return;try{e.currentTarget=this}catch(e){}try{e.eventPhase=t}catch(e){}e.removed=!1,i=i.slice();for(var o=0;o<n&&!e.immediatePropagationStopped;o++){var s=i[o];s.handleEvent?s.handleEvent(e):s(e),e.removed&&(this.removeEventListener(e.type,s,1==t),e.removed=!1)}}}};var o=new i,s=function(){return new i};function a(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];this.data=t,this.type=e,this.bubbles=n,this.cancelable=r,this.timeStamp=(new Date).getTime(),this.defaultPrevented=!1,this.propagationStopped=!1,this.immediatePropagationStopped=!1,this.removed=!1,this.target,this.currentTarget,this.eventPhase=0}function u(){this.listenerBoxes=[],this.listenersNeedCloning=!1}function l(e,t){switch(e){case 0:return function(){return t.apply(this,arguments)};case 1:return function(e){return t.apply(this,arguments)};case 2:return function(e,n){return t.apply(this,arguments)};case 3:return function(e,n,r){return t.apply(this,arguments)};case 4:return function(e,n,r,i){return t.apply(this,arguments)};case 5:return function(e,n,r,i,o){return t.apply(this,arguments)};case 6:return function(e,n,r,i,o,s){return t.apply(this,arguments)};case 7:return function(e,n,r,i,o,s,a){return t.apply(this,arguments)};case 8:return function(e,n,r,i,o,s,a,u){return t.apply(this,arguments)};case 9:return function(e,n,r,i,o,s,a,u,l){return t.apply(this,arguments)};case 10:return function(e,n,r,i,o,s,a,u,l,c){return t.apply(this,arguments)};default:throw Error("First argument to _arity must be a non-negative integer no greater than ten")}}a.prototype={preventDefault:function(){this.defaultPrevented=!0},stopPropagation:function(){this.propagationStopped=!0},stopImmediatePropagation:function(){this.immediatePropagationStopped=this.propagationStopped=!0},remove:function(){this.removed=!0},clone:function(){return new a(this.type,this.data,this.bubbles,this.cancelable)}},u.prototype={getNumListeners:function(){return this.listenerBoxes.length},connect:function(e,t){this.registerListener(e,t,!1)},connectOnce:function(e,t){this.registerListener(e,t,!0)},disconnect:function(e,t){this.listenersNeedCloning&&(this.listenerBoxes=this.listenerBoxes.slice(),this.listenersNeedCloning=!1);for(var n=this.listenerBoxes.length;n--;)if(this.listenerBoxes[n].listener==e&&this.listenerBoxes[n].scope==t)return void this.listenerBoxes.splice(n,1)},disconnectAll:function(){for(var e=this.listenerBoxes.length;e--;)this.disconnect(this.listenerBoxes[e].listener,this.listenerBoxes[e].scope)},emit:function(){for(var e=this,t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];this.listenersNeedCloning=!0,this.listenerBoxes.forEach(function(t){var r=t.scope,i=t.listener;t.once&&e.disconnect(i,r),i.apply(r,n)}),this.listenersNeedCloning=!1},registerListener:function(e,t,n){var r=this.listenerBoxes.filter(function(n){return n.listener===e&&n.scope===t});if(r.length){var i=r.find(function(e){return e.once&&!n}),o=r.find(function(e){return n&&!e.once});if(i)throw Error("You cannot addOnce() then try to add() the same listener without removing the relationship first.");if(o)throw Error("You cannot add() then addOnce() the same listener without removing the relationship first.")}else this.listenersNeedCloning&&(this.listenerBoxes=this.listenerBoxes.slice()),this.listenerBoxes.push({listener:e,scope:t,once:n})}};var c=function(e){return e};function f(e){var t,n=e.length;return 1===n?(t=e,function e(n){return 0===arguments.length?e:t.apply(this,arguments)}):l(n,function e(t,n,r){return function(){for(var i=[],o=0,s=t,a=0;a<n.length||o<arguments.length;){var u;a<n.length?u=n[a]:(u=arguments[o],o+=1),i[a]=u,s-=1,a+=1}return s<=0?r.apply(this,i):l(s,e(t,i,r))}}(n,[],e))}var h=f(function(e,t,n){for(var r=0,i=n.length;r<i;)t=e(t,n[r]),r+=1;return t});function d(e,t){return function(){return t.call(this,e.apply(this,arguments))}}function p(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];t.reverse();var r=t[0],i=t.slice(1);return l(r.length,h(d,r,i))}var v=f(function(e,t){for(var n=0,r=t.length,i=[];n<r;)e(t[n])&&(i[i.length]=t[n]),n+=1;return i}),m=f(function(e,t){for(var n=0,r=t.length;n<r;){if(e(t[n]))return t[n];n+=1}});function g(e){var n,r=!1;return Array.isArray(e)&&(r=!0),e||(r=!1),"object"!==(void 0===e?"undefined":t(e))&&(r=!1),n=e,"[object String]"===Object.prototype.toString.call(n)&&(r=!1),1===e.nodeType&&(r=!!e.length),0===e.length&&(r=!0),e.length>0&&(r=e.hasOwnProperty(0)&&e.hasOwnProperty(e.length-1)),r}function y(e){for(var t,n,r,i=[],o=0,s=e.length;o<s;){if(g(e[o]))for(r=0,n=(t=y(e[o])).length;r<n;)i[i.length]=t[r],r+=1;else i[i.length]=e[o];o+=1}return i}var b=f(function(e,t){for(var n=t.length,r=0;r<n;)e(t[r]),r+=1;return t}),x=f(function(e,t){for(var n=0,r=t.length,i=[];n<r;n++)i[n]=e(t[n]);return i}),w=f(function(e,t){return x(function(t){return t[e]},t)});function _(e,t,n){return p(function(e){return e.length>0?n(e):[]},v(function(e){return e.length>0}),x(t),v(function(e){return e.querySelectorAll}),y,w(e))}var E=function(e,t){var n=new u,r=new u,i=_("addedNodes",t,n.emit.bind(n)),o=_("removedNodes",t,r.emit.bind(r)),s=new MutationObserver(function(e){o(e),i(e)});return s.observe(e,{attributes:!1,childList:!0,characterData:!1,subtree:!0}),Object.freeze({onAdded:n,onRemoved:r,dispose:function(){s.disconnect(),n.disconnectAll(),r.disconnectAll(),s=null,n=null,r=null,i=null,o=null}})},L=/[xy]/g,S=f(function(e,t,n){var r="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(L,function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)});return e.setAttribute("mediatorid",r),{mediatorId:r,node:e,dispose:n(e,t)||c}}),A=function(e,t){return!!m(function(e){return e.node===t},e)};function O(e){var t=[].slice.call(e.querySelectorAll("[data-mediator]"),0);return e.getAttribute("data-mediator")&&t.unshift(e),t}var P=function(e,t,n){return f(function(r,i,o){return i(e(o)).then(t(o,r)).then(n)})},j=f(function(e,t){return e[t.getAttribute("data-mediator")]});function B(e){var t=e.definitions,n=void 0===t?{}:t,r=e.dispatcher,i=void 0===r?s():r,o=[],a=j(n);var u=P(a,S,function(e){return o.push(e),o});return Object.freeze({dispose:function(){o.forEach(function(e){e&&(e.dispose(),e.node=null)}),o=null,i.removeAllEventListeners(),i=null,u=null,n=null,a=null},destroy:function(e){for(var t=0;t<o.length;t++){var n=o[t];n&&n.node===e&&(n.dispose(),n.node=null,o[t]=null,o.splice(t,1))}return o},findMediator:u(i),hasMediator:function(e){return!!a(e)&&!A(o,e)},getAllElements:O})}var N=["a","abbr","acronym","address","applet","area","article","aside","audio","b","base","basefont","bdi","bdo","big","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","datalist","dd","del","details","dfn","dialog","dir","div","dl","dt","em","embed","fieldset","figcaption","figure","font","footer","form","frame","frameset","h1 ","h2","h3","h4","h5","h6","head","header","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","menu","menuitem","meta","meter","nav","noframes","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strike","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","tt","u","ul","var","video","wbr"].map(function(e){return":not("+e+")"}).reduce(function(e,t){return e+t},"*");function C(e){return[e].concat([].slice.call(e.querySelectorAll(N),0))}function M(e,t){return function(n,r){return function(i){var o="";if(!e(n.tagName.toLowerCase())){if(!(o=n.tagName.toLowerCase()).match(/-/gim))throw Error("The name of a custom element must contain a dash (-). So <x-tags>, <my-element>, and <my-awesome-app> are all valid names, while <tabs> and <foo_bar> are not.");window.customElements.define(o,function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,r))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i),t}()),t(o)}return o}}}var k=f(function(e,t){return e[t.tagName.toLowerCase()]});e.Loader=r,e.EventDispatcher=o,e.makeDispatcher=s,e.RJSEvent=a,e.Signal=u,e.DomWatcher=E,e.MediatorHandler=B,e.bootstrap=function(e){var t,n,i,o=e.definitions,s=e.loader,a=void 0===s?r():s,u=e.root,l=void 0===u?document.body:u,c=e.handler||B({definitions:o}),f=e.domWatcher||E(l,c.getAllElements),h=(t=c.findMediator(a.load),n=c.hasMediator,p(function(e){return Promise.all(e)},x(t),v(n),y));f.onAdded.connect(h),f.onRemoved.connect((i=c.destroy,p(b(i),y)));var d,m,g=(d=h,m=c.getAllElements,p(d,x(m),function(e){return[e]}))(l);return{promise:g,dispose:function(){f.dispose(),c.dispose(),f=null,c=null,h=null,o=null,a=null,l=null,g=null}}},e.CustomElementHandler=function(e){var t=e.definitions,n=void 0===t?{}:t,r=e.dispatcher,i=void 0===r?s():r,o={};var a=f(function(e,t){return!!e[t]}),u=k(n),l=P(u,M(a(o),function(e){return o[e]=!0,o}),c);return Object.freeze({dispose:c,destroy:c,findMediator:l(i),hasMediator:function(e){var t=e.tagName.toLowerCase();return!!u(e)&&!a(o,t)},getAllElements:C})}});