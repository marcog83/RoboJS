!function(e,t){if("function"==typeof define&&define.amd)define("robojs",["exports"],t);else if("undefined"!=typeof exports)t(exports);else{var n={};t(n),e.robojs=n}}(this,function(e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},t=function(e,t,n){window.require([e],t,n)},v=function(){var r=0<arguments.length&&void 0!==arguments[0]?arguments[0]:t;return Object.freeze({load:function(n){return new Promise(function(e,t){return r(n,e,t)})}})},l=function(){var t=void 0;try{t=self}catch(e){t=global}var n=t.EventTarget;try{new n}catch(e){(n=function(){}).prototype={addEventListener:function(e,t){if(this.listeners_||(this.listeners_=Object.create(null)),e in this.listeners_){var n=this.listeners_[e];n.indexOf(t)<0&&n.push(t)}else this.listeners_[e]=[t]},removeEventListener:function(e,t){if(this.listeners_&&e in this.listeners_){var n=this.listeners_[e],r=n.indexOf(t);0<=r&&(1===n.length?delete this.listeners_[e]:n.splice(r,1))}},dispatchEvent:function(e){if(!this.listeners_)return!0;var t=this;e.__defineGetter__("target",function(){return t});var n=e.type,r=0;if(n in this.listeners_)for(var i=this.listeners_[n].concat(),o=0;o<i.length;o++){var s=i[o];s.handleEvent?r|=!1===s.handleEvent.call(s,e):r|=!1===s.call(this,e)}return!r&&!e.defaultPrevented}}}return n}();function r(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null,n=2<arguments.length&&void 0!==arguments[2]&&arguments[2],r=3<arguments.length&&void 0!==arguments[3]&&arguments[3];this.data=t,this.type=e,this.bubbles=n,this.cancelable=r,this.timeStamp=(new Date).getTime(),this.defaultPrevented=!1,this.propagationStopped=!1,this.immediatePropagationStopped=!1,this.removed=!1,this.target,this.currentTarget,this.eventPhase=0}function a(){this.listenerBoxes=[],this.listenersNeedCloning=!1}function c(e,c){switch(e){case 0:return function(){return c.apply(this,arguments)};case 1:return function(e){return c.apply(this,arguments)};case 2:return function(e,t){return c.apply(this,arguments)};case 3:return function(e,t,n){return c.apply(this,arguments)};case 4:return function(e,t,n,r){return c.apply(this,arguments)};case 5:return function(e,t,n,r,i){return c.apply(this,arguments)};case 6:return function(e,t,n,r,i,o){return c.apply(this,arguments)};case 7:return function(e,t,n,r,i,o,s){return c.apply(this,arguments)};case 8:return function(e,t,n,r,i,o,s,a){return c.apply(this,arguments)};case 9:return function(e,t,n,r,i,o,s,a,u){return c.apply(this,arguments)};case 10:return function(e,t,n,r,i,o,s,a,u,l){return c.apply(this,arguments)};default:throw Error("First argument to _arity must be a non-negative integer no greater than ten")}}r.prototype={preventDefault:function(){this.defaultPrevented=!0},stopPropagation:function(){this.propagationStopped=!0},stopImmediatePropagation:function(){this.immediatePropagationStopped=this.propagationStopped=!0},remove:function(){this.removed=!0},clone:function(){return new r(this.type,this.data,this.bubbles,this.cancelable)}},a.prototype={getNumListeners:function(){return this.listenerBoxes.length},connect:function(e,t){this.registerListener(e,t,!1)},connectOnce:function(e,t){this.registerListener(e,t,!0)},disconnect:function(e,t){this.listenersNeedCloning&&(this.listenerBoxes=this.listenerBoxes.slice(),this.listenersNeedCloning=!1);for(var n=this.listenerBoxes.length;n--;)if(this.listenerBoxes[n].listener==e&&this.listenerBoxes[n].scope==t)return void this.listenerBoxes.splice(n,1)},disconnectAll:function(){for(var e=this.listenerBoxes.length;e--;)this.disconnect(this.listenerBoxes[e].listener,this.listenerBoxes[e].scope)},emit:function(){for(var r=this,e=arguments.length,i=Array(e),t=0;t<e;t++)i[t]=arguments[t];this.listenersNeedCloning=!0,this.listenerBoxes.forEach(function(e){var t=e.scope,n=e.listener;e.once&&r.disconnect(n,t),n.apply(t,i)}),this.listenersNeedCloning=!1},registerListener:function(t,n,r){var e=this.listenerBoxes.filter(function(e){return e.listener===t&&e.scope===n});if(e.length){var i=e.find(function(e){return e.once&&!r}),o=e.find(function(e){return r&&!e.once});if(i)throw Error("You cannot addOnce() then try to add() the same listener without removing the relationship first.");if(o)throw Error("You cannot add() then addOnce() the same listener without removing the relationship first.")}else this.listenersNeedCloning&&(this.listenerBoxes=this.listenerBoxes.slice()),this.listenerBoxes.push({listener:t,scope:n,once:r})}};var f=function(e){return e};function d(e){var t,n=e.length;return 1===n?(t=e,function e(){return 0===arguments.length?e:t.apply(this,arguments)}):c(n,function o(s,a,u){return function(){for(var e=[],t=0,n=s,r=0;r<a.length||t<arguments.length;){var i=void 0;r<a.length?i=a[r]:(i=arguments[t],t+=1),e[r]=i,n-=1,r+=1}return n<=0?u.apply(this,e):c(n,o(s,e,u))}}(n,[],e))}var o=d(function(e,t,n){for(var r=0,i=n.length;r<i;)t=e(t,n[r]),r+=1;return t});function s(e,t){return function(){return t.call(this,e.apply(this,arguments))}}function g(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];t.reverse();var r=t[0],i=t.slice(1);return c(r.length,o(s,r,i))}var m=d(function(e,t){for(var n=0,r=t.length,i=[];n<r;)e(t[n])&&(i[i.length]=t[n]),n+=1;return i}),h=d(function(e,t){for(var n=0,r=t.length;n<r;){if(e(t[n]))return t[n];n+=1}}),i=function(e){return null!=e&&0<=e.length&&"[object Array]"===Object.prototype.toString.call(e)};function u(e){var t;return!!e&&(!!(Array.isArray||i)(e)||"object"===(void 0===e?"undefined":n(e))&&(t=e,"[object String]"!==Object.prototype.toString.call(t)&&(1===e.nodeType?!!e.length:0===e.length||0<e.length&&(e.hasOwnProperty(0)&&e.hasOwnProperty(e.length-1)))))}function y(e){for(var t=void 0,n=void 0,r=void 0,i=[],o=0,s=e.length;o<s;){if(u(e[o]))for(r=0,n=(t=y(e[o])).length;r<n;)i[i.length]=t[r],r+=1;else i[i.length]=e[o];o+=1}return i}var b=d(function(e,t){for(var n=t.length,r=0;r<n;)e(t[r]),r+=1;return t}),x=d(function(e,t){for(var n=0,r=t.length,i=[];n<r;n++)i[n]=e(t[n]);return i}),p=d(function(t,e){return x(function(e){return e[t]},e)});function w(e){return e.filter(function(e,t,n){return n.indexOf(e)==t})}function _(e,t,n){return g(function(e){return 0<e.length?n(e):[]},w,y,m(function(e){return 0<e.length}),x(t),m(function(e){return e.querySelectorAll}),y,p(e))}var O=function(e,t){var n=new a,r=new a,i=_("addedNodes",t,n.emit.bind(n)),o=_("removedNodes",t,r.emit.bind(r)),s=new MutationObserver(function(e){o(e),i(e)});return s.observe(e,{attributes:!1,childList:!0,characterData:!1,subtree:!0}),Object.freeze({onAdded:n,onRemoved:r,dispose:function(){s.disconnect(),n.disconnectAll(),r.disconnectAll(),o=i=r=n=s=null}})},E=/[xy]/g,S=d(function(e,t,n){var r="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(E,function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)});e.setAttribute("mediatorid",r);var i={mediatorId:r,node:e,dispose:f};e.parentNode&&(i={mediatorId:r,node:e,dispose:n(e,t)||f});return i}),A=function(e){e&&(e.dispose(),e.node=null)};function j(e){var t=[].slice.call(e.querySelectorAll("[data-mediator]"),0);return e.getAttribute("data-mediator")&&t.unshift(e),t}var B=function(r,i,o){return d(function(e,t,n){return t(r(n)).then(i(n,e)).then(o)})},P=d(function(e,t){return e[t.getAttribute("data-mediator")]});function N(e){var t=e||{},n=t.definitions,r=void 0===n?{}:n,i=t.dispatcher,o=void 0===i?new l:i,s=[],a=P(r);var u=B(a,S,function(e){return s.push(e),s});return Object.freeze({dispose:function(){s.forEach(A),s=null,o.listeners_=null,a=r=u=o=null},destroy:function(e){return s=function(e,t){for(var n=t.length,r=0;r<n;r++){var i=t[r];i?i.node&&i.node!==e||(i.dispose&&i.dispose(),i.node=null,t[r]=null):t[r]=null}return t.filter(function(e){return e})}(e,s)},findMediator:u(o),hasMediator:function(e){return!!a(e)&&(t=e,!h(function(e){return e.node===t},s));var t},getAllElements:j})}var C=["a","abbr","acronym","address","applet","area","article","aside","audio","b","base","basefont","bdi","bdo","big","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","datalist","dd","del","details","dfn","dialog","dir","div","dl","dt","em","embed","fieldset","figcaption","figure","font","footer","form","frame","frameset","h1 ","h2","h3","h4","h5","h6","head","header","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","menu","menuitem","meta","meter","nav","noframes","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strike","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","tt","u","ul","var","video","wbr"].map(function(e){return":not("+e+")"}).reduce(function(e,t){return e+t},"*");function L(e){return[e].concat([].slice.call(e.querySelectorAll(C),0))}function M(i,o){return function(t,r){return function(n){var e="";if(!i(t.tagName.toLowerCase())){if(!(e=t.tagName.toLowerCase()).match(/-/gim))throw Error("The name of a custom element must contain a dash (-). So <x-tags>, <my-element>, and <my-awesome-app> are all valid names, while <tabs> and <foo_bar> are not.");window.customElements.define(e,function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,r))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,n),t}()),o(e)}return e}}}var T=d(function(e,t){return e[t.tagName.toLowerCase()]});e.Loader=v,e.EventTarget=l,e.RJSEvent=r,e.Signal=a,e.DomWatcher=O,e.MediatorHandler=N,e.bootstrap=function(e){var t,n,r,i=e.definitions,o=e.loader,s=void 0===o?v():o,a=e.root,u=void 0===a?document.body:a,l=e.handler||N({definitions:i}),c=e.domWatcher||O(u,l.getAllElements),f=(t=l.findMediator(s.load),n=l.hasMediator,g(function(e){return Promise.all(e)},x(t),m(n),y));c.onAdded.connect(f),c.onRemoved.connect((r=l.destroy,g(b(r),y)));var d,h,p=(d=f,h=l.getAllElements,g(d,x(h),function(e){return[e]})(u));return{promise:p,dispose:function(){c.dispose(),l.dispose(),p=u=s=i=f=l=c=null}}},e.CustomElementHandler=function(e){var t=e.definitions,n=void 0===t?{}:t,r=e.dispatcher,i=void 0===r?new l:r,o={};var s=d(function(e,t){return!!e[t]}),a=T(n),u=B(a,M(s(o),function(e){return o[e]=!0,o}),f);return Object.freeze({dispose:f,destroy:f,findMediator:u(i),hasMediator:function(e){var t=e.tagName.toLowerCase();return!!a(e)&&!s(o,t)},getAllElements:L})}});